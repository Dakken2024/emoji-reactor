<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ§  è¡¨æƒ…ç¬¦å·ååº”å †</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f4f9;
      color: #333;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #game-container {
      text-align: center;
      max-width: 500px;
      width: 90%;
      margin-top: 30px;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    #scoreboard {
      font-size: 1rem;
      margin-bottom: 20px;
    }

    #target-emoji {
      font-size: 6rem;
      margin: 20px 0;
      transition: transform 0.2s ease;
    }

    #timer-bar {
      height: 12px;
      background-color: #eee;
      border-radius: 6px;
      overflow: hidden;
      margin: 20px auto;
      width: 90%;
    }

    .timer-fill {
      height: 100%;
      background-color: #4caf50;
      width: 100%;
      transition: width linear 0.1s;
    }

    #options {
      display: flex;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .option-btn {
      font-size: 2.5rem;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 10px;
      background-color: white;
      border: 2px solid #ddd;
      transition: all 0.2s ease;
    }

    .option-btn.correct {
      background-color: #a5d6a7;
      transform: scale(1.1);
    }

    .option-btn.wrong {
      background-color: #ef9a9a;
      transform: scale(1.1);
    }

    .option-btn:hover {
      background-color: #e0e0ff;
      transform: scale(1.1);
    }

    .controls {
      margin: 10px 0;
    }

    button#pause-btn {
      padding: 10px 16px;
      font-size: 1rem;
      margin: 0 10px;
      cursor: pointer;
      border: none;
      background-color: #9e9e9e;
      color: white;
      border-radius: 5px;
    }

    button#pause-btn.paused {
      background-color: #fdd835;
    }

    #help {
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      max-width: 500px;
      width: 90%;
      margin-top: 20px;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    /* è‡ªå®šä¹‰æ¨¡æ€æ¡† */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .modal {
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      width: 80%;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }

    .modal button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1rem;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .modal button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>

<div id="game-container">
  <h1>ğŸ§  è¡¨æƒ…ç¬¦å·ååº”å †</h1>

  <div id="scoreboard">
    å½“å‰å¾—åˆ†ï¼š<span id="current-score">0</span><br/>
    æœ€é«˜å¾—åˆ†ï¼š<span id="high-score">0</span>
  </div>

  <div id="target-emoji">ğŸ˜Š</div>

  <div id="timer-bar">
    <div class="timer-fill"></div>
  </div>

  <div id="options"></div>

  <div class="controls">
    <button id="pause-btn">â¸ï¸ æš‚åœ</button>
  </div>
</div>

<!-- ä½¿ç”¨è¯´æ˜ -->
<div id="help">
  <strong>ğŸ® å¦‚ä½•ç©ï¼š</strong><br/>
  - å±å¹•ä¸­å¤®ä¼šå¿«é€Ÿæ˜¾ç¤ºä¸€ä¸ªç›®æ ‡ Emojiã€‚<br/>
  - ä¸‹æ–¹æœ‰å¤šä¸ªé€‰é¡¹ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯æ­£ç¡®çš„åŒ¹é…é¡¹ã€‚<br/>
  - åœ¨å€’è®¡æ—¶ç»“æŸå‰ç‚¹å‡»æ­£ç¡® Emoji å¯è·å¾—åˆ†æ•°ï¼<br/>
  - éšç€å¾—åˆ†æå‡ï¼Œååº”æ—¶é—´ä¼šé€æ¸å˜çŸ­ã€‚<br/>
  - ç‚¹é”™æˆ–è¶…æ—¶å°†ç»“æŸæ¸¸æˆã€‚<br/>
  - æ”¯æŒæš‚åœåŠŸèƒ½ï¼Œç‚¹å‡» "â¸ï¸ æš‚åœ" å³å¯æš‚åœå½“å‰æ¸¸æˆã€‚
</div>

<!-- æ¨¡æ€æ¡† -->
<div class="modal-overlay" id="modal">
  <div class="modal">
    <p id="modal-message"></p>
    <button onclick="restartGame()">é‡æ–°å¼€å§‹</button>
  </div>
</div>

<script>
  const emojis = [
    "ğŸ˜€", "ğŸ˜", "ğŸ˜¢", "ğŸ˜¡", "ğŸ¥³", "ğŸ¤”", "ğŸ˜±", "ğŸ‘",
    "ğŸ”¥", "ğŸš€", "ğŸ‰", "ğŸ˜­", "ğŸ˜¤", "ğŸ¤", "ğŸ’¡", "ğŸ¤–",
    "ğŸ•", "ğŸ®", "ğŸŒˆ", "âš½", "ğŸ’©", "ğŸ’¥", "ğŸ˜´", "ğŸ˜‹"
  ];

  let score = 0;
  let highScore = parseInt(localStorage.getItem("emojiReactorHighScore")) || 0;
  let timeLeft = 2;
  let gameInterval;
  let isPaused = false;
  let correctEmoji;

  const targetEmojiDiv = document.getElementById("target-emoji");
  const scoreDisplay = document.getElementById("current-score");
  const highScoreDisplay = document.getElementById("high-score");
  const modal = document.getElementById("modal");
  const modalMessage = document.getElementById("modal-message");

  function getRandomEmoji() {
    return emojis[Math.floor(Math.random() * emojis.length)];
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function updateOptions(correctEmoji) {
    const options = [correctEmoji];
    while (options.length < 4) {
      const rand = getRandomEmoji();
      if (!options.includes(rand)) options.push(rand);
    }
    shuffle(options);

    const optionsContainer = document.getElementById("options");
    optionsContainer.innerHTML = options.map(emoji => `
      <div class="option-btn" onclick="checkAnswer('${emoji}')">${emoji}</div>
    `).join("");
  }

  function checkAnswer(selectedEmoji) {
    if (isPaused) return;

    const correctEmoji = targetEmojiDiv.textContent;

    // è·å–æ‰€æœ‰æŒ‰é’®å…ƒç´ 
    const buttons = document.querySelectorAll(".option-btn");
    buttons.forEach(btn => {
      btn.disabled = true;
      if (btn.textContent === correctEmoji) {
        btn.classList.add("correct");
      } else if (btn.textContent === selectedEmoji) {
        btn.classList.add("wrong");
      }
    });

    if (selectedEmoji === correctEmoji) {
      setTimeout(() => {
        score++;
        scoreDisplay.textContent = score;
        if (score > highScore) {
          highScore = score;
          localStorage.setItem("emojiReactorHighScore", highScore);
          highScoreDisplay.textContent = highScore;
        }
        timeLeft = Math.max(0.5, timeLeft - 0.1);
        startNextRound();
      }, 200);
    } else {
      showModal(`âŒ é”™å•¦ï¼\n\nä½ çš„æœ€ç»ˆå¾—åˆ†æ˜¯ï¼š${score}`);
    }
  }

  function startNextRound() {
    clearInterval(gameInterval);
    animateTimerBar();
    const target = getRandomEmoji();
    targetEmojiDiv.textContent = target;
    correctEmoji = target;
    updateOptions(target);
  }

  function animateTimerBar() {
    const timerFill = document.querySelector(".timer-fill");
    timerFill.style.width = "100%";

    gameInterval = setInterval(() => {
      if (!isPaused) {
        timeLeft -= 0.1;
        let newWidth = timeLeft * 50;
        timerFill.style.width = `${newWidth}%`;

        if (timeLeft <= 0) {
          clearInterval(gameInterval);
          showModal(`â° æ—¶é—´åˆ°ï¼\n\nä½ çš„æœ€ç»ˆå¾—åˆ†æ˜¯ï¼š${score}`);
        }
      }
    }, 100);
  }

  function showModal(message) {
    modalMessage.textContent = message;
    modal.style.display = 'flex';
    isPaused = true;
  }

  function restartGame() {
    score = 0;
    timeLeft = 2;
    isPaused = false;
    scoreDisplay.textContent = score;
    modal.style.display = 'none';
    startNextRound();
  }

  function togglePause() {
    isPaused = !isPaused;
    document.getElementById("pause-btn").classList.toggle("paused", isPaused);
  }

  // åˆå§‹åŒ–æ¸¸æˆ
  function initGame() {
    scoreDisplay.textContent = score;
    highScoreDisplay.textContent = highScore;
    document.getElementById("pause-btn").addEventListener("click", togglePause);
    startNextRound();
  }

  window.onload = () => {
    initGame();
  };
  if ('serviceWorker' in navigator) {    
    navigator.serviceWorker.register('/service-worker.js');
  }
</script>

</body>
</html>